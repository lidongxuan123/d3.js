<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <style>
        html,
        body {
            height: 100%;
            width: 100%;
            padding: 0;
            margin: 0;
        }

        .container {
            width: 600px;
            height: 400px;
            border: 1px solid #666;
            margin: 0 auto;
        }

        .rectBg {
            background: #0087ed;
        }

        .color {
            color: red;
        }
    </style>
</head>

<body style="">
    <script src="https://d3js.org/d3.v5.js"></script>
    <script>
        // 柱状图
        let sty = {
            width: '100%',
            height: "100%",
        }

        var svg = d3.select("body").append("svg").attr("width", sty.width).attr("height", sty.height)

        // // var react = svg.append("react").
        // var dataset = [ 250 , 210 , 170 , 130 , 90 ];
        // svg.selectAll('rect').data(dataset).enter().append("rect").attr("x", 20).attr("y",function(d,i){
        //     return i * 25
        // }).attr("width",function(d){
        //      return d;
        // })
        // .attr("height",25-2)
        // .attr("fill","steelblue");


        // var dataset = [1.2, 2.3, 0.9, 1.5, 3.3];
        // var min =d3.min(dataset)
        // var max = d3.max(dataset)

        // var linear = d3.scaleLinear()
        //         .domain([min, max])
        //         .range([0, 300]);
        // // svg.append(linear)
        // // linear(0.9);    //返回 0
        // // linear(2.3);    //返回 175
        // // linear(3.3);    //返回 300


        // var dataset = [ 2.5 , 2.1 , 1.7 , 1.3 , 0.9 ];
        // var min =d3.min(dataset)
        // var max = d3.max(dataset)
        // var linear = d3.scaleLinear().domain([0, max]).range([0,200])

        // // 创建横坐标
        // var axis = d3.axisBottom(linear).ticks(7)

        // // 添加坐标轴

        // svg.append('g').call(axis)




        // 完整的柱形图

        // var padding = {
        //     left: 30,
        //     right: 30,
        //     top: 20,
        //     bottom: 30,
        // }

        // // 定义数组
        // var dataset = [10, 20, 30, 40, 33, 24, 12, 5];

        // // x轴比例尺
        // // 元素居中
        // let xScale = d3.scaleBand().domain([0,1,2,3,4,5,6,7]).range([0, 340])
        // let widthRect = xScale(1)
        // // 定义y轴比例尺

        // let min = d3.min(dataset)
        // let max = d3.max(dataset)
        // let yScale = d3.scaleLinear().domain([0, max]).range([300, 0])
        // // 定义x轴

        // var xAis = d3.axisBottom(xScale).ticks(7)
        // var yAis = d3.axisLeft(yScale).ticks(7)

        // svg.append('g').attr("transform","translate(" + padding.left + "," + 320 + ")").call(xAis)
        // svg.append('g').attr("transform","translate(" + padding.left + "," + padding.top + ")").call(yAis)

        // // 添加柱状图
        //     svg.selectAll('rect').data(dataset).enter().append("rect").attr("transform", "translate(" + padding.left+ ',' +padding.top+ ")").attr("x",function(d,i) {
        //         return xScale(i) + 2
        //         // return 400 - padding.left -padding.right
        //     }).attr("y", function(d, i) {
        //         return yScale(d)
        //     }).attr("width", function(d, i) {
        //         return widthRect-5
        //     })
        //     .attr("height", function(d) {
        //         return 400-50 - padding.top -padding.bottom -yScale(d)
        //     })
        //     // .attr("style","background: red")
        //     // 添加文字
        //     var text = svg.selectAll(".text").data(dataset).enter().append("text").attr("transform", "translate(" + padding.left + "," + padding.top + ")")
        //     .attr("x",function(d,i) {
        //         return xScale(i)
        //     }).attr("y",function(d){
        //         return yScale(d)
        //     }).attr("dx", function() {
        //         return 10
        //     }).attr("dy", function() {
        //         return 10
        //     }).text(function(d) {
        //         return d
        //     })



        // let rect = svg.append('rect').attr("x",10).attr('y', 10).attr("width", 20).attr("height", 20)

        // rect.attr("fill","red").transition().duration(1000, 'linear').delay(400).attr("fill", "blue")

        // 添加文字
        // let color = {
        //     color:'red'
        // }
        // 文字添加颜色  未成功
        // let text = svg.append('text').attr('x', 10).attr('y', 10).text("你好svg")

        // text.attr("transform", "translate(100, 100)").style("color", 'red')

        // let dataset = [1,2,3,4,5,6]
        // var p = d3.select("body").selectAll("p")
        // var update = p.data(dataset)
        // console.log(update)
        // var exit = update.exit(dataset)
        // console.log(exit)
        // update.text(function(d){
        //     return "update" + d
        // })
        // exit.text(function(d) {
        //     return "exit"
        // })
        // exit.remove()

        // 饼状图

        // var dataset = [30, 10, 43, 55, 13];
        // // 定义布局
        // var pie = d3.pie()

        // // 返回值赋给变量pie，此时pie可以当作函数使用
        // var piedata = pie(dataset)

        // console.log(piedata)

        // // 定义外半径
        // var outRadius = 150

        // var inRadius = 80

        // var arc = d3.arc().innerRadius(inRadius).outerRadius(outRadius)
        // // 设置饼状图的颜色
        // var color = d3.scaleOrdinal(d3.schemeCategory10)

        // var arcs = svg.selectAll("g").data(piedata).enter().append("g").attr("transform", "translate(300, 300)")
        // arcs.append("path").attr("fill", function (d, i) {
        //     return color(i)
        // }).attr("d", function (d) {
        //     return arc(d)
        // }).on("mouseover",function(d, i){
        //     console.log(d)
        //         d3.select(this)
        //         // .attr("transform", "translate(10,-10)")
        //         .transition().duration(500).attr("fill","yellow")
        //         // .padAngle(function(){
        //         //     return 1
        //         // })
        // }).on("mouseout",function(d,i) {
        //     d3.select(this)
        //     // .attr("transform", "translate(0,0)")
        //     .transition()
        //     .duration(500)
        //     .attr("fill",color(i));
        // });

        // arcs.append("text").attr("transform", function (d) {
        //     return "translate(" + arc.centroid(d) + ")"
        // }).attr("text-anchor", "middle")
        //     .text(function (d) {
        //         return d.data;
        //     })


        // // 力导向图

        // var nodes = [{ name: "桂林" }, { name: "广州" },
        // { name: "厦门" }, { name: "杭州" },
        // { name: "上海" }, { name: "青岛" },
        // { name: "天津" }];

        // var edges = [{ source: 0, target: 1 }, { source: 0, target: 2 },
        // { source: 0, target: 3 }, { source: 1, target: 4 },
        // { source: 1, target: 5 }, { source: 1, target: 6 }];

        // //    布局数据转换
        // // 格式化数据
        // var force = d3.forceSimulation(nodes).force("charge", d3.forceManyBody()).force("link", d3.forceLink(edges)).force("center", d3.forceCenter())
        // // force.start()

        // console.log(nodes)
        // console.log(edges)


        // 添加连线
        var svg_edges = svg.selectAll("line").data(edges).enter().append('line').style("stroke", "#ccc").style("troke-width", 1)

        // 添加颜色
        var color = d3.scaleOrdinal(d3.schemeCategory10)

        var drag = d3.drag();
        // 添加节点
        var svg_nodes = svg.selectAll("circle").data(nodes)
            .enter()
            .append("circle")
            .attr("r", 5)
            .attr("transform", "translate(300,300)")
            .style("fill", function (d, i) {
                return color(i);
            }).attr("cx", function (d) {
                return d.x
            }).attr("cy", function (d) {
                return d.y
            }).call(drag)
            // .call(force.drag);  //使得节点能够拖动

        // 添加描述文字
        // var svg_texts = svg.selectAll("text")
        //     .data(nodes)
        //     .enter()
        //     .append("text")
        //     .style("fill", "black")
        //     .attr("dx", 20)
        //     .attr("dy", 8)
        //     .text(function (d) {
        //         return d.name;
        //     });


        // force.on("tick", function () { //对于每一个时间间隔
        //     //更新连线坐标
        //     svg_edges.attr("x1", function (d) { return d.source.x; })
        //         .attr("y1", function (d) { return d.source.y; })
        //         .attr("x2", function (d) { return d.target.x; })
        //         .attr("y2", function (d) { return d.target.y; });

        //     //更新节点坐标
        //     svg_nodes.attr("cx", function (d) { return d.x; })
        //         .attr("cy", function (d) { return d.y; });

        //     //更新文字坐标
        //     svg_texts.attr("x", function (d) { return d.x; })
        //         .attr("y", function (d) { return d.y; });
        // });
    </script>
</body>

</html>